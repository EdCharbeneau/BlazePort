@page "/"
@inherits IndexBase
@using BlazePort.Components

<div class="row">

    <div class="col-md-6">
        @if (IsValid)
        {
            <div class="form-group">
                <label class="h3">Departing: </label>
                <span class="h3 text-muted">@form.TripStart.ToShortDateString()</span>
            </div>
            <div class="form-group">
                <label class="h3">Passengers: </label>
                <span class="h3 text-muted">@form.PassengerCount</span>
            </div>
            <div class="form-group">
                <label class="h3">Departure from: </label>
                <span class="h3 text-muted">@DepartureFrom</span>
            </div>
            <div class="form-group">
                <label class="h3">Arriving to: </label>
                <span class="h3 text-muted">@ArrivalTo</span>
            </div>
            <TelerikButton OnClick="ShowConfigurationPanel">Edit Trip</TelerikButton>
            <TelerikButton Class="k-primary">Book Now</TelerikButton>
        }
        else
        {
            <TelerikButton OnClick="ShowConfigurationPanel" Class="k-primary">Start Trip</TelerikButton>
        }
    </div>
    <div class="col-md-6">
        <!-- Calculated -->
        <div class="form-group">
            <label class="h3">Time until trip: </label>
            <span class="h3 text-muted">T-minus TIME</span>
        </div>
        <div class="form-group">
            <label class="h3">Total Price: </label>
            <span class="h3 text-muted">@totalPrice.ToString("C2")</span>
        </div>
        <div class="form-group">
            <label class="h3">Trip Time: </label>
            <span class="h3 text-muted">15 Hours</span>
        </div>
        <div class="form-group">
            <label class="h3">Trip Distance: </label>
            <span class="h3 text-muted">38M Miles</span>
        </div>
    </div>
</div>

<FlyoutPanel Width="50%" @ref="ConfigurationPanel">
    <TitleTemplate>
        Trip Options
    </TitleTemplate>
    <ContentTemplate>
        <EditForm Model="form" OnValidSubmit="@OnTripEstimateTripCost"
                  OnInvalidSubmit="@InvalidSubmit">
            <ValidationSummary />
            <DataAnnotationsValidator />
            <div class="form-group">
                <label>Dates</label>
                <TelerikDatePicker @bind-Value="form.TripStart" Min="@DateTime.Now" />
                <ValidationMessage For="@(()=> form.TripStart)"></ValidationMessage>
            </div>

            <div class="form-group">
                <label>Passenger</label>
                <InputNumber @bind-Value="form.PassengerCount" Class="form-control"></InputNumber>
                <ValidationMessage For="@(()=> form.PassengerCount)"></ValidationMessage>
            </div>

            <LocationDropdowns LocationLabel="Departure"
                               LocationSelectedValue="@form.SelectedDepartureId"
                               Locations="@DepartureLocations"
                               OnLocationChanged="OnLocationChanged"
                               PortLabel="Port of Travel"
                               Ports="@DeparturePorts"
                               PortSelectedValue="@form.SelectedPortOfTravelId"
                               OnPortChanged="OnDeparturePortChanged" />

            <LocationDropdowns LocationLabel="Destination"
                               LocationSelectedValue="@form.SelectedDestinationId"
                               Locations="@DestinationLocations"
                               OnLocationChanged="OnDestinationChanged"
                               PortLabel="Port of Entry"
                               Ports="@DestinationPorts"
                               PortSelectedValue="@form.SelectedPortOfEntryId"
                               OnPortChanged="OnPortOfEntryChanged" />

            <div class="form-group">
                <button class="btn btn-outline-primary" type="submit">Estimate Trip Cost</button>
            </div>

            <!--
              Service Provider: A | B
              Payment Method: Currency | Miles
            -->
        </EditForm>
    </ContentTemplate>
</FlyoutPanel>